<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مكتبة العلوم الشرعية واللغوية المتكاملة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #8D6E63;
            --secondary: #5D4037;
            --accent: #D7CCC8;
            --light: #EFEBE9;
            --dark: #4E342E;
            --gold: #C9A769;
            --dark-gold: #A8864A;
            --admin: #2c3e50;
            --guest: #3498db;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f2e9 0%, #e6dfd1 100%);
            background-attachment: fixed;
            color: #3a2618;
            line-height: 1.8;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(to right, var(--secondary), var(--dark));
            color: #fff;
            padding: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-bottom: 5px solid var(--gold);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 2.5rem;
            color: var(--gold);
        }
        
        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 1px;
            font-family: 'Arial', sans-serif;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .search-bar {
            display: flex;
            max-width: 400px;
            width: 100%;
        }
        
        .search-bar input {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 30px 0 0 30px;
            font-size: 1rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            direction: rtl;
        }
        
        .search-bar button {
            background: var(--gold);
            color: var(--dark);
            border: none;
            padding: 12px 25px;
            border-radius: 0 30px 30px 0;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .search-bar button:hover {
            background: var(--dark-gold);
        }
        
        .action-btn {
            background: var(--gold);
            color: var(--dark);
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            background: var(--dark-gold);
            transform: translateY(-2px);
        }
        
        .admin-btn {
            background: var(--admin);
            color: white;
        }
        
        .guest-btn {
            background: var(--guest);
            color: white;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 30px;
        }
        
        .user-info i {
            font-size: 1.2rem;
        }
        
        /* Navigation */
        nav {
            background: var(--primary);
            padding: 15px 0;
            position: sticky;
            top: 90px;
            z-index: 999;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .categories-container {
            overflow-x: auto;
            padding-bottom: 10px;
            scrollbar-width: thin;
            flex: 1;
        }
        
        .categories {
            display: flex;
            flex-wrap: nowrap;
            gap: 8px;
            min-width: max-content;
        }
        
        .category-btn {
            background: var(--light);
            color: var(--dark);
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            white-space: nowrap;
        }
        
        .category-btn:hover, .category-btn.active {
            background: var(--gold);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .view-options {
            display: flex;
            gap: 10px;
        }
        
        .view-btn {
            background: var(--light);
            color: var(--dark);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .view-btn.active, .view-btn:hover {
            background: var(--gold);
            transform: translateY(-2px);
        }
        
        /* Book Grid */
        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .books-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }
        
        .books-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .books-table th, .books-table td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid #eee;
        }
        
        .books-table th {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }
        
        .books-table tr:last-child td {
            border-bottom: none;
        }
        
        .books-table tr:hover {
            background: #f9f7f1;
        }
        
        .book-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid #e0d6c9;
        }
        
        .book-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
        }
        
        .book-list-item {
            display: flex;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .book-list-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }
        
        .book-list-image {
            width: 120px;
            height: 180px;
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .book-list-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .book-list-info {
            padding: 20px;
            flex-grow: 1;
        }
        
        .book-image {
            height: 300px;
            overflow: hidden;
            position: relative;
            background: #f5f2e9;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .book-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .book-card:hover .book-image img {
            transform: scale(1.05);
        }
        
        .book-category {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--secondary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .book-info {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .book-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--dark);
            font-family: 'Arial', sans-serif;
        }
        
        .book-author {
            color: var(--primary);
            margin-bottom: 15px;
            font-style: italic;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .book-author:hover {
            text-decoration: underline;
            transform: translateX(-5px);
        }
        
        .book-meta {
            display: flex;
            justify-content: space-between;
            margin-top: auto;
            color: #7f6e5d;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
            padding-top: 10px;
        }
        
        .book-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .action-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--light);
            color: var(--dark);
        }
        
        .action-icon:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .edit-icon:hover {
            background: #3498db;
            color: white;
        }
        
        .delete-icon:hover {
            background: #e74c3c;
            color: white;
        }
        
        /* Book Details Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal-content {
            background: white;
            margin: 3% auto;
            width: 85%;
            max-width: 900px;
            border-radius: 15px;
            overflow: hidden;
            animation: modalOpen 0.5s ease;
        }
        
        @keyframes modalOpen {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            background: linear-gradient(to right, var(--secondary), var(--dark));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .close-btn:hover {
            transform: rotate(90deg);
        }
        
        .modal-body {
            display: flex;
            padding: 30px;
            gap: 30px;
        }
        
        .modal-image {
            flex: 0 0 40%;
            display: flex;
            align-items: center;
        }
        
        .modal-image img {
            width: 100%;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            max-height: 500px;
            object-fit: cover;
        }
        
        .modal-details {
            flex: 1;
        }
        
        .modal-title {
            font-size: 2rem;
            color: var(--dark);
            margin-bottom: 10px;
            font-family: 'Arial', sans-serif;
        }
        
        .modal-author {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 20px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .modal-author:hover {
            text-decoration: underline;
            transform: translateX(-5px);
        }
        
        .book-meta-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .meta-item {
            background: var(--light);
            padding: 10px 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        .category-link {
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .publisher-link {
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .category-link:hover, .publisher-link:hover {
            text-decoration: underline;
            transform: translateX(-5px);
        }
        
        .book-location {
            background: #f0f7ff;
            border: 1px dashed #4a90e2;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .location-icon {
            font-size: 1.5rem;
            color: #4a90e2;
        }
        
        .book-summary {
            background: #f9f7f1;
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid var(--gold);
            margin-top: 20px;
        }
        
        .summary-title {
            font-size: 1.4rem;
            color: var(--dark);
            margin-bottom: 15px;
            font-family: 'Arial', sans-serif;
        }
        
        /* Login Modal */
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .login-content {
            background: white;
            margin: 10% auto;
            width: 85%;
            max-width: 500px;
            border-radius: 15px;
            overflow: hidden;
            animation: modalOpen 0.5s ease;
        }
        
        .login-header {
            background: linear-gradient(to right, var(--secondary), var(--dark));
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .login-body {
            padding: 30px;
        }
        
        .user-type {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .user-type-btn {
            flex: 1;
            padding: 20px;
            border: 2px solid #eee;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .user-type-btn:hover, .user-type-btn.active {
            border-color: var(--gold);
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .user-type-btn i {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }
        
        .admin-btn-modal {
            color: var(--admin);
        }
        
        .guest-btn-modal {
            color: var(--guest);
        }
        
        .login-form {
            display: none;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .submit-btn {
            background: var(--gold);
            color: var(--dark);
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1.1rem;
            display: block;
            width: 100%;
            margin: 20px 0;
            transition: all 0.3s ease;
        }
        
        .submit-btn:hover {
            background: var(--dark-gold);
            transform: translateY(-3px);
        }
        
        /* Footer */
        footer {
            background: var(--dark);
            color: var(--gold);
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
        }
        
        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .footer-logo {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--gold);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: var(--accent);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-links a:hover {
            color: var(--gold);
        }
        
        /* Responsive Design */
        @media (max-width: 900px) {
            .modal-body, .add-book-body {
                flex-direction: column;
            }
            
            .modal-image {
                max-width: 300px;
                margin: 0 auto;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .logo h1 {
                font-size: 1.5rem;
            }
            
            .logo {
                justify-content: center;
            }
            
            nav {
                top: 180px;
            }
            
            .header-actions {
                width: 100%;
                justify-content: center;
            }
            
            .nav-container {
                flex-direction: column;
            }
            
            .book-list-item {
                flex-direction: column;
            }
            
            .book-list-image {
                width: 100%;
                height: 200px;
            }
        }
        
        @media (max-width: 600px) {
            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .modal-content, .add-book-content, .login-content {
                width: 95%;
            }
            
            .categories {
                gap: 6px;
            }
            
            .category-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .user-type {
                flex-direction: column;
            }
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1e9e0;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }
        
        /* Section Title */
        .section-title {
            text-align: center;
            margin: 40px 0 20px;
            position: relative;
            padding-bottom: 15px;
            color: var(--dark);
            font-size: 2rem;
            font-family: 'Arial', sans-serif;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--gold);
            border-radius: 2px;
        }
        
        /* Statistics */
        .stats {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin: 40px 0;
            text-align: center;
        }
        
        .stat-box {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            flex: 1;
            min-width: 200px;
            border-top: 4px solid var(--gold);
        }
        
        .stat-number {
            font-size: 2.5rem;
            color: var(--dark);
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: var(--primary);
            font-weight: 600;
        }
        
        /* Empty Library Message */
        .empty-library {
            text-align: center;
            padding: 50px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 30px 0;
        }
        
        .empty-library i {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .empty-library h3 {
            font-size: 1.8rem;
            color: var(--dark);
            margin-bottom: 15px;
        }
        
        /* Confirmation Modal */
        .confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1100;
        }
        
        .confirmation-content {
            background: white;
            max-width: 500px;
            margin: 15% auto;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .confirmation-header {
            background: var(--dark);
            color: white;
            padding: 15px 20px;
            font-size: 1.2rem;
        }
        
        .confirmation-body {
            padding: 30px;
            text-align: center;
        }
        
        .confirmation-text {
            font-size: 1.1rem;
            margin-bottom: 25px;
        }
        
        .confirmation-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .confirm-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .confirm-delete {
            background: #e74c3c;
            color: white;
        }
        
        .confirm-delete:hover {
            background: #c0392b;
        }
        
        .confirm-cancel {
            background: #bdc3c7;
            color: #2c3e50;
        }
        
        .confirm-cancel:hover {
            background: #95a5a6;
        }
        
        /* Add Book Modal */
        .add-book-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .add-book-content {
            background: white;
            margin: 3% auto;
            width: 85%;
            max-width: 700px;
            border-radius: 15px;
            overflow: hidden;
            animation: modalOpen 0.5s ease;
        }
        
        .add-book-header {
            background: linear-gradient(to right, var(--secondary), var(--dark));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .add-book-body {
            padding: 30px;
        }
        
        .add-book-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-row {
            grid-column: span 2;
        }
        
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            min-height: 100px;
            resize: vertical;
        }
        
        .form-actions {
            grid-column: span 2;
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 20px;
        }
        
        .cancel-btn {
            background: #bdc3c7;
            color: #2c3e50;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .cancel-btn:hover {
            background: #95a5a6;
        }
        
        .save-btn {
            background: var(--gold);
            color: var(--dark);
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .save-btn:hover {
            background: var(--dark-gold);
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="login-modal" id="login-modal">
        <div class="login-content">
            <div class="login-header">
                <h2>تسجيل الدخول إلى المكتبة</h2>
                <p>اختر نوع المستخدم للبدء</p>
            </div>
            <div class="login-body">
                <div class="user-type">
                    <div class="user-type-btn" id="guest-btn">
                        <i class="fas fa-user guest-btn-modal"></i>
                        <h3>ضيف</h3>
                        <p>تصفح الكتب بدون تعديل</p>
                    </div>
                    <div class="user-type-btn" id="admin-btn">
                        <i class="fas fa-user-shield admin-btn-modal"></i>
                        <h3>مشرف</h3>
                        <p>إدارة المكتبة بالكامل</p>
                    </div>
                </div>
                
                <div class="login-form" id="admin-form">
                    <div class="form-group">
                        <label for="admin-code">كود المشرف</label>
                        <input type="password" id="admin-code" placeholder="أدخل كود المشرف">
                    </div>
                    <button class="submit-btn" id="admin-login-btn">تسجيل الدخول كمشرف</button>
                </div>
                
                <div class="login-form" id="guest-form">
                    <p>سوف تدخل كضيف، يمكنك تصفح الكتب والبحث فيها لكن لا يمكنك تعديلها.</p>
                    <button class="submit-btn" id="guest-login-btn">الدخول كضيف</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Header -->
    <header id="main-header" style="display: none;">
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-book-quran"></i>
                <h1>مكتبة العلوم الشرعية واللغوية المتكاملة</h1>
            </div>
            <div class="header-actions">
                <div class="search-bar">
                    <input type="text" id="search-input" placeholder="ابحث عن كتاب أو مؤلف أو دار نشر...">
                    <button id="search-btn"><i class="fas fa-search"></i></button>
                </div>
                <button class="action-btn" id="add-book-btn" style="display: none;">
                    <i class="fas fa-plus"></i> إضافة كتاب
                </button>
                <div class="user-info" id="user-info">
                    <i class="fas fa-user"></i>
                    <span>مرحبًا، <span id="username">ضيف</span></span>
                </div>
                <button class="action-btn guest-btn" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                </button>
            </div>
        </div>
    </header>
    
    <!-- Navigation -->
    <nav id="main-nav" style="display: none;">
        <div class="container nav-container">
            <div class="categories-container">
                <div class="categories">
                    <button class="category-btn active" data-category="all">جميع التصنيفات</button>
                    <button class="category-btn" data-category="العقيدة">العقيدة</button>
                    <button class="category-btn" data-category="الفرق والردود">الفرق والردود</button>
                    <button class="category-btn" data-category="التفسير">التفسير</button>
                    <button class="category-btn" data-category="علوم القرآن">علوم القرآن</button>
                    <button class="category-btn" data-category="التجويد والقراءات">التجويد والقراءات</button>
                    <button class="category-btn" data-category="كتب السنة">كتب السنة</button>
                    <button class="category-btn" data-category="شروح الحديث">شروح الحديث</button>
                    <button class="category-btn" data-category="التاريخ والأطراف">التاريخ والأطراف</button>
                    <button class="category-btn" data-category="العلل والسؤلات">العلل والسؤلات</button>
                    <button class="category-btn" data-category="علوم الحديث">علوم الحديث</button>
                    <button class="category-btn" data-category="أصول الفقه">أصول الفقه</button>
                    <button class="category-btn" data-category="علوم الفقه">علوم الفقه</button>
                    <button class="category-btn" data-category="المنطق">المنطق</button>
                    <button class="category-btn" data-category="الفقه الحنفي">الفقه الحنفي</button>
                    <button class="category-btn" data-category="الفقه المالكي">الفقه المالكي</button>
                    <button class="category-btn" data-category="الفقه الشافعي">الفقه الشافعي</button>
                    <button class="category-btn" data-category="الفقه الحنبلي">الفقه الحنبلي</button>
                    <button class="category-btn" data-category="الفقه العام">الفقه العام</button>
                    <button class="category-btn" data-category="مسائل فقهية">مسائل فقهية</button>
                    <button class="category-btn" data-category="السياسة الشرعية">السياسة الشرعية</button>
                    <button class="category-btn" data-category="الفرائض والوصايا">الفرائض والوصايا</button>
                    <button class="category-btn" data-category="الفتاوى">الفتاوى</button>
                    <button class="category-btn" data-category="الرقائق والآداب">الرقائق والآداب</button>
                    <button class="category-btn" data-category="السيرة النبوية">السيرة النبوية</button>
                    <button class="category-btn" data-category="التاريخ">التاريخ</button>
                    <button class="category-btn" data-category="التراجم والطبقات">التراجم والطبقات</button>
                    <button class="category-btn" data-category="الأنساب">الأنساب</button>
                    <button class="category-btn" data-category="البلدان والرحلات">البلدان والرحلات</button>
                    <button class="category-btn" data-category="كتب اللغة">كتب اللغة</button>
                    <button class="category-btn" data-category="الغريب والمعاجم">الغريب والمعاجم</button>
                    <button class="category-btn" data-category="النحو والصرف">النحو والصرف</button>
                    <button class="category-btn" data-category="الأدب">الأدب</button>
                    <button class="category-btn" data-category="العروض والقوافي">العروض والقوافي</button>
                    <button class="category-btn" data-category="الدواوين الشعرية">الدواوين الشعرية</button>
                    <button class="category-btn" data-category="البلاغة">البلاغة</button>
                    <button class="category-btn" data-category="الجوامع">الجوامع</button>
                    <button class="category-btn" data-category="فهارس الكتب">فهارس الكتب</button>
                    <button class="category-btn" data-category="الطب">الطب</button>
                    <button class="category-btn" data-category="كتب عامة">كتب عامة</button>
                    <button class="category-btn" data-category="علوم أخرى">علوم أخرى</button>
                </div>
            </div>
            
            <div class="view-options">
                <button class="view-btn active" data-view="grid"><i class="fas fa-th"></i></button>
                <button class="view-btn" data-view="list"><i class="fas fa-list"></i></button>
                <button class="view-btn" data-view="table"><i class="fas fa-table"></i></button>
            </div>
        </div>
    </nav>
    
    <!-- Statistics -->
    <div class="container" id="stats-section" style="display: none;">
        <div class="stats">
            <div class="stat-box">
                <div class="stat-number" id="books-count">12</div>
                <div class="stat-label">كتاب في المكتبة</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">42</div>
                <div class="stat-label">تصنيف رئيسي</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">9</div>
                <div class="stat-label">مؤلف مختلف</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">6</div>
                <div class="stat-label">دار نشر</div>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="container" id="main-content" style="display: none;">
        <h2 class="section-title" id="section-title">أحدث الكتب المضافة</h2>
        
        <!-- Grid View -->
        <div class="books-grid" id="books-grid"></div>
        
        <!-- List View -->
        <div class="books-list" id="books-list" style="display: none;"></div>
        
        <!-- Table View -->
        <div class="books-table-container" id="books-table-container" style="display: none;">
            <table class="books-table">
                <thead>
                    <tr>
                        <th>العنوان</th>
                        <th>المؤلف</th>
                        <th>التصنيف</th>
                        <th>الطبعة</th>
                        <th>دار النشر</th>
                        <th>سنة النشر</th>
                        <th>الإجراءات</th>
                    </tr>
                </thead>
                <tbody id="books-table-body"></tbody>
            </table>
        </div>
    </div>
    
    <!-- Book Details Modal -->
    <div class="modal" id="book-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">تفسير القرآن العظيم</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-image">
                    <img id="modal-img" src="https://images.unsplash.com/photo-1589998059171-988d887df646?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80" alt="كتاب">
                </div>
                <div class="modal-details">
                    <h3 class="modal-author" id="modal-author">ابن كثير</h3>
                    
                    <div class="book-meta-info">
                        <div class="meta-item">
                            <i class="fas fa-book"></i>
                            <span>التصنيف: <span id="modal-category" class="category-link">التفسير</span></span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-print"></i>
                            <span>الطبعة: <span id="modal-edition">السابعة</span></span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-building"></i>
                            <span>دار النشر: <span id="modal-publisher" class="publisher-link">دار السلام</span></span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-calendar"></i>
                            <span>سنة النشر: <span id="modal-year">2019</span></span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-file"></i>
                            <span>الصفحات: <span id="modal-pages">3250</span></span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-book-open"></i>
                            <span>المجلدات: <span id="modal-volumes">8</span></span>
                        </div>
                    </div>
                    
                    <div class="book-location">
                        <i class="fas fa-map-marker-alt location-icon"></i>
                        <div>
                            <h4>مكان الكتاب في المكتبة</h4>
                            <p id="modal-location">الرف العلوي - القسم الشرعي - الرف رقم 3</p>
                        </div>
                    </div>
                    
                    <div class="book-summary">
                        <h4 class="summary-title">وصف الكتاب</h4>
                        <p id="modal-summary">تفسير القرآن العظيم المشهور بـ "تفسير ابن كثير"، للإمام عماد الدين أبي الفداء إسماعيل بن كثير القرشي الدمشقي، هو من أشهر كتب التفسير بالمأثور. يعتمد على تفسير القرآن بالقرآن، ثم بالأحاديث المشهورة، ثم بأقوال الصحابة والتابعين. يتميز التفسير بمنهجه السلفي، واعتماده على الآثار الصحيحة، وتجنب الإسرائيليات إلا ما صح منها، وردّه على المبتدعة والفرق الضالة. يعتبر هذا التفسير من أهم المراجع في التفسير بالمأثور، وقد حظي بقبول واسع بين العلماء وطلبة العلم عبر العصور.</p>
                    </div>
                    
                    <div class="book-actions" id="modal-actions" style="display: none;">
                        <div class="action-icon edit-icon" title="تعديل الكتاب" id="edit-book-btn">
                            <i class="fas fa-edit"></i>
                        </div>
                        <div class="action-icon delete-icon" title="حذف الكتاب" id="delete-book-btn">
                            <i class="fas fa-trash"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Book Modal -->
    <div class="add-book-modal" id="add-book-modal">
        <div class="add-book-content">
            <div class="add-book-header">
                <h2>إضافة كتاب جديد</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="add-book-body">
                <form class="add-book-form" id="add-book-form">
                    <div class="form-group">
                        <label for="book-title">عنوان الكتاب</label>
                        <input type="text" id="book-title" required>
                    </div>
                    <div class="form-group">
                        <label for="book-author">المؤلف</label>
                        <input type="text" id="book-author" required>
                    </div>
                    <div class="form-group">
                        <label for="book-category">التصنيف</label>
                        <select id="book-category" required>
                            <option value="التفسير">التفسير</option>
                            <option value="كتب السنة">كتب السنة</option>
                            <option value="الفقه الشافعي">الفقه الشافعي</option>
                            <option value="التاريخ">التاريخ</option>
                            <option value="العقيدة">العقيدة</option>
                            <option value="أصول الفقه">أصول الفقه</option>
                            <option value="الفرق والردود">الفرق والردود</option>
                            <option value="علوم القرآن وأصول التفسير">علوم القرآن وأصول التفسير</option>
                            <option value="التجويد والقراءات">التجويد والقراءات</option>
                            <option value="شروح الحديث">شروح الحديث</option>
                            <option value="التاريخ والأطراف">التاريخ والأطراف</option>
                            <option value="العلل والسؤلات الحديثية">العلل والسؤلات الحديثية</option>
                            <option value="علوم الحديث">علوم الحديث</option>
                            <option value="علوم الفقه والقواعد الفقهية">علوم الفقه والقواعد الفقهية</option>
                            <option value="المنطق">المنطق</option>
                            <option value="الفقه الحنفي">الفقه الحنفي</option>
                            <option value="الفقه المالكي">الفقه المالكي</option>
                            <option value="الفقه الحنبلي">الفقه الحنبلي</option>
                            <option value="الفقه العام">الفقه العام</option>
                            <option value="مسائل فقهية">مسائل فقهية</option>
                            <option value="السياسة الشرعية والقضاء">السياسة الشرعية والقضاء</option>
                            <option value="الفرائض والوصايا">الفرائض والوصايا</option>
                            <option value="الفتاوى">الفتاوى</option>
                            <option value="الرقائق والآداب والأذكار">الرقائق والآداب والأذكار</option>
                            <option value="السيرة النبوية">السيرة النبوية</option>
                            <option value="التراجم والطبقات">التراجم والطبقات</option>
                            <option value="الأنساب">الأنساب</option>
                            <option value="البلدان والرحلات">البلدان والرحلات</option>
                            <option value="كتب اللغة">كتب اللغة</option>
                            <option value="الغريب والمعاجم">الغريب والمعاجم</option>
                            <option value="النحو والصرف">النحو والصرف</option>
                            <option value="الأدب">الأدب</option>
                            <option value="العروض والقوافي">العروض والقوافي</option>
                            <option value="الدواوين الشعرية">الدواوين الشعرية</option>
                            <option value="البلاغة">البلاغة</option>
                            <option value="الجوامع">الجوامع</option>
                            <option value="فهارس الكتب والأدلة">فهارس الكتب والأدلة</option>
                            <option value="الطب">الطب</option>
                            <option value="كتب عامة">كتب عامة</option>
                            <option value="علوم أخرى">علوم أخرى</option>

                        </select>
                    </div>
                    <div class="form-group">
                        <label for="book-edition">الطبعة</label>
                        <input type="text" id="book-edition" required>
                    </div>
                    <div class="form-group">
                        <label for="book-publisher">دار النشر</label>
                        <input type="text" id="book-publisher" required>
                    </div>
                    <div class="form-group">
                        <label for="book-year">سنة النشر</label>
                        <input type="text" id="book-year" required>
                    </div>
                    <div class="form-group">
                        <label for="book-pages">عدد الصفحات</label>
                        <input type="text" id="book-pages" required>
                    </div>
                    <div class="form-group">
                        <label for="book-volumes">عدد المجلدات</label>
                        <input type="text" id="book-volumes" required>
                    </div>
                    <div class="form-group">
                        <label for="book-image">رابط صورة الكتاب</label>
                        <input type="text" id="book-image" required>
                    </div>
                    <div class="form-group">
                        <label for="book-location">مكان الكتاب في المكتبة</label>
                        <input type="text" id="book-location" required>
                    </div>
                    <div class="form-group form-row">
                        <label for="book-summary">وصف الكتاب</label>
                        <textarea id="book-summary" required></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="cancel-btn" id="cancel-add-btn">إلغاء</button>
                        <button type="submit" class="save-btn">حفظ الكتاب</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="confirmation-modal" id="confirmation-modal">
        <div class="confirmation-content">
            <div class="confirmation-header">
                <h3>تأكيد الحذف</h3>
            </div>
            <div class="confirmation-body">
                <p class="confirmation-text" id="confirmation-message">هل أنت متأكد من حذف هذا الكتاب؟ لا يمكن التراجع عن هذا الإجراء.</p>
                <div class="confirmation-buttons">
                    <button class="confirm-btn confirm-delete" id="confirm-delete-btn">حذف</button>
                    <button class="confirm-btn confirm-cancel" id="cancel-delete-btn">إلغاء</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer id="main-footer" style="display: none;">
        <div class="container footer-content">
            <div class="footer-logo">
                <i class="fas fa-book"></i>
            </div>
            <p>مكتبة العلوم الشرعية واللغوية المتكاملة © 2023</p>
            <p>نظام متكامل لإدارة المكتبات المتخصصة في العلوم الإسلامية والعربية</p>
            <div class="footer-links">
                <a href="#"><i class="fas fa-info-circle"></i> عن المكتبة</a>
                <a href="#"><i class="fas fa-book"></i> الكتب الجديدة</a>
                <a href="#"><i class="fas fa-envelope"></i> اتصل بنا</a>
                <a href="#"><i class="fas fa-question-circle"></i> المساعدة</a>
                <a href="#"><i class="fas fa-download"></i> تطبيق الجوال</a>
            </div>
        </div>
    </footer>
    
    <script>
        // Sample Book Data
        let books = [
            {
                id: 1,
                title: "تفسير القرآن العظيم",
                author: "ابن كثير",
                category: "التفسير",
                publisher: "دار طيبة",
                image: "https://images.unsplash.com/photo-1589998059171-988d887df646?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                edition: "السابعة",
                year: "2019",
                pages: "3250",
                volumes: "8",
                location: "الرف العلوي - القسم الشرعي - الرف رقم 3",
                summary: "تفسير القرآن العظيم المشهور بـ 'تفسير ابن كثير'، للإمام عماد الدين أبي الفداء إسماعيل بن كثير القرشي الدمشقي، هو من أشهر كتب التفسير بالمأثور. يعتمد على تفسير القرآن بالقرآن، ثم بالأحاديث المشهورة، ثم بأقوال الصحابة والتابعين. يتميز التفسير بمنهجه السلفي، واعتماده على الآثار الصحيحة، وتجنب الإسرائيليات إلا ما صح منها، وردّه على المبتدعة والفرق الضالة. يعتبر هذا التفسير من أهم المراجع في التفسير بالمأثور، وقد حظي بقبول واسع بين العلماء وطلبة العلم عبر العصور."
            },
            {
                id: 2,
                title: "صحيح البخاري",
                author: "الإمام البخاري",
                category: "كتب السنة",
                publisher: "دار المعرفة",
                image: "https://images.unsplash.com/photo-1568667256549-094345857637?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                edition: "المحققة",
                year: "2020",
                pages: "2450",
                volumes: "4",
                location: "القسم الأوسط - رف الحديث - رقم 12",
                summary: "صحيح البخاري هو أصح كتب الحديث النبوي عند أهل السنة والجماعة. جمعه الإمام أبو عبد الله محمد بن إسماعيل البخاري، واستغرق في تحريره ستة عشر عامًا. انتقى أحاديثه من ستمائة ألف حديث، ولم يضع فيه إلا ما صح عنده. اشترط البخاري شروطًا خاصة في قبول الرواية، أهمها: اتصال السند، وعدالة الرواة، وضبطهم، وخلو الحديث من الشذوذ والعلة. يعد الكتاب من أهم مصادر التشريع الإسلامي، وقد حظي باهتمام بالغ من العلماء عبر العصور."
            },
            {
                id: 3,
                title: "الأم",
                author: "الإمام الشافعي",
                category: "الفقه الشافعي",
                publisher: "دار الكتب العلمية",
                image: "https://images.unsplash.com/photo-1592496431122-2349e0fbc666?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                edition: "الأولى",
                year: "2018",
                pages: "3120",
                volumes: "8",
                location: "القسم الشرعي - رف الفقه - رقم 7",
                summary: "كتاب 'الأم' للإمام محمد بن إدريس الشافعي، هو من أهم كتب الفقه الشافعي وأوسعها. جمع فيه الشافعي أصول مذهبه وفروعه، مع الاستدلال بالكتاب والسنة والإجماع والقياس. يتميز الكتاب بعرضه المنهجي للقضايا الفقهية، واهتمامه ببيان العلل والأدلة. يعتبر هذا الكتاب المرجع الأساسي للمذهب الشافعي، وقد اعتنى به العلماء شرحًا وتعليقًا واختصارًا عبر القرون. يغطي الكتاب جميع أبواب الفقه من الطهارة إلى الفرائض."
            },
            {
                id: 4,
                title: "البداية والنهاية",
                author: "ابن كثير",
                category: "التاريخ",
                publisher: "دار ابن حزم",
                image: "https://images.unsplash.com/photo-1588666309990-d68f08e3d4a6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                edition: "الثانية",
                year: "2016",
                pages: "7500",
                volumes: "15",
                location: "القسم التاريخي - الرف السفلي - رقم 5",
                summary: "البداية والنهاية هو عمل موسوعي تاريخي ضخم، ألفه الحافظ ابن كثير. يتناول التاريخ منذ بدء الخلق إلى نهايته، بدءًا من بداية خلق السماوات والأرض، والملائكة، وخلق آدم، وقصص الأنبياء، ثم تاريخ الأمم القديمة، وتاريخ العرب قبل الإسلام، ثم السيرة النبوية، وتاريخ الخلفاء الراشدين، فالأمويين، فالعباسيين، إلى عصر المؤلف. يتميز الكتاب بمنهجه في نقد الروايات التاريخية، واعتماده على المصادر الموثوقة، وتجنب الإسرائيليات والأساطير."
            }
        ];
        
        // Current user state
        let currentUser = null;
        const ADMIN_CODE = "Bx]Reh8.\"@eK!=$";
        
        // Current book for modal actions
        let currentBookInModal = null;
        
        // Current category filter
        let currentCategory = "all";
        let currentAuthorFilter = null;
        let currentPublisherFilter = null;
        
        // DOM Elements
        const loginModal = document.getElementById('login-modal');
        const mainHeader = document.getElementById('main-header');
        const mainNav = document.getElementById('main-nav');
        const statsSection = document.getElementById('stats-section');
        const mainContent = document.getElementById('main-content');
        const mainFooter = document.getElementById('main-footer');
        const booksGrid = document.getElementById('books-grid');
        const booksList = document.getElementById('books-list');
        const booksTableContainer = document.getElementById('books-table-container');
        const booksTableBody = document.getElementById('books-table-body');
        const categoryBtns = document.querySelectorAll('.category-btn');
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        const bookModal = document.getElementById('book-modal');
        const addBookBtn = document.getElementById('add-book-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const userInfo = document.getElementById('user-info');
        const usernameSpan = document.getElementById('username');
        const confirmationModal = document.getElementById('confirmation-modal');
        const confirmDeleteBtn = document.getElementById('confirm-delete-btn');
        const cancelDeleteBtn = document.getElementById('cancel-delete-btn');
        const confirmationMessage = document.getElementById('confirmation-message');
        const addBookModal = document.getElementById('add-book-modal');
        const addBookForm = document.getElementById('add-book-form');
        const cancelAddBtn = document.getElementById('cancel-add-btn');
        const sectionTitle = document.getElementById('section-title');
        
        // Modal elements
        const modalTitle = document.getElementById('modal-title');
        const modalImg = document.getElementById('modal-img');
        const modalAuthor = document.getElementById('modal-author');
        const modalCategory = document.getElementById('modal-category');
        const modalEdition = document.getElementById('modal-edition');
        const modalPublisher = document.getElementById('modal-publisher');
        const modalYear = document.getElementById('modal-year');
        const modalPages = document.getElementById('modal-pages');
        const modalSummary = document.getElementById('modal-summary');
        const modalVolumes = document.getElementById('modal-volumes');
        const modalLocation = document.getElementById('modal-location');
        const modalActions = document.getElementById('modal-actions');
        const closeBtn = document.querySelector('.close-btn');
        const deleteBookBtn = document.getElementById('delete-book-btn');
        const editBookBtn = document.getElementById('edit-book-btn');
        const closeAddBtn = document.querySelectorAll('.close-btn')[1];
        
        // Login elements
        const guestBtn = document.getElementById('guest-btn');
        const adminBtn = document.getElementById('admin-btn');
        const adminForm = document.getElementById('admin-form');
        const guestForm = document.getElementById('guest-form');
        const adminCodeInput = document.getElementById('admin-code');
        const adminLoginBtn = document.getElementById('admin-login-btn');
        const guestLoginBtn = document.getElementById('guest-login-btn');
        
        // View buttons
        const viewBtns = document.querySelectorAll('.view-btn');
        
        // Functions
        function renderBooks(booksToRender) {
            booksGrid.innerHTML = '';
            booksList.innerHTML = '';
            booksTableBody.innerHTML = '';
            
            if (booksToRender.length === 0) {
                booksGrid.innerHTML = `
                    <div class="empty-library">
                        <i class="fas fa-book-open"></i>
                        <h3>لا توجد كتب في هذا التصنيف</h3>
                        <p>استخدم زر "إضافة كتاب" لإضافة كتب جديدة إلى مكتبتك</p>
                    </div>
                `;
                return;
            }
            
            // Render grid view
            booksToRender.forEach(book => {
                const bookCard = document.createElement('div');
                bookCard.className = 'book-card';
                bookCard.dataset.id = book.id;
                
                bookCard.innerHTML = `
                    <div class="book-image">
                        <img src="${book.image}" alt="${book.title}">
                        <span class="book-category">${book.category}</span>
                    </div>
                    <div class="book-info">
                        <h3 class="book-title">${book.title}</h3>
                        <p class="book-author">${book.author}</p>
                        <div class="book-meta">
                            <span>الطبعة: ${book.edition}</span>
                            <span>${book.year}</span>
                        </div>
                    </div>
                `;
                
                bookCard.addEventListener('click', () => openBookModal(book));
                booksGrid.appendChild(bookCard);
            });
            
            // Render list view
            booksToRender.forEach(book => {
                const listItem = document.createElement('div');
                listItem.className = 'book-list-item';
                listItem.dataset.id = book.id;
                
                listItem.innerHTML = `
                    <div class="book-list-image">
                        <img src="${book.image}" alt="${book.title}">
                    </div>
                    <div class="book-list-info">
                        <h3 class="book-title">${book.title}</h3>
                        <p class="book-author">${book.author}</p>
                        <div class="book-meta">
                            <span>التصنيف: ${book.category}</span>
                            <span>الطبعة: ${book.edition}</span>
                            <span>سنة النشر: ${book.year}</span>
                        </div>
                    </div>
                `;
                
                listItem.addEventListener('click', () => openBookModal(book));
                booksList.appendChild(listItem);
            });
            
            // Render table view
            booksToRender.forEach(book => {
                const row = document.createElement('tr');
                row.dataset.id = book.id;
                
                row.innerHTML = `
                    <td>${book.title}</td>
                    <td>${book.author}</td>
                    <td>${book.category}</td>
                    <td>${book.edition}</td>
                    <td>${book.publisher}</td>
                    <td>${book.year}</td>
                    <td>
                        <button class="view-btn" onclick="openBookModal(${JSON.stringify(book).replace(/"/g, '&quot;')})">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                
                booksTableBody.appendChild(row);
            });
            
            document.getElementById('books-count').textContent = books.length;
        }
        
        function openBookModal(book) {
            modalTitle.textContent = book.title;
            modalImg.src = book.image;
            modalAuthor.textContent = book.author;
            modalAuthor.dataset.author = book.author;
            modalCategory.textContent = book.category;
            modalCategory.dataset.category = book.category;
            modalEdition.textContent = book.edition;
            modalPublisher.textContent = book.publisher;
            modalPublisher.dataset.publisher = book.publisher;
            modalYear.textContent = book.year;
            modalPages.textContent = book.pages;
            modalSummary.textContent = book.summary;
            modalVolumes.textContent = book.volumes;
            modalLocation.textContent = book.location;
            
            // Store the current book for actions
            currentBookInModal = book;
            
            // Show actions only for admin
            if (currentUser && currentUser.role === 'admin') {
                modalActions.style.display = 'flex';
            } else {
                modalActions.style.display = 'none';
            }
            
            bookModal.style.display = 'block';
        }
        
        function loginUser(role) {
            currentUser = {
                role: role,
                username: role === 'admin' ? 'المشرف' : 'الضيف'
            };
            
            loginModal.style.display = 'none';
            mainHeader.style.display = 'block';
            mainNav.style.display = 'block';
            statsSection.style.display = 'block';
            mainContent.style.display = 'block';
            mainFooter.style.display = 'block';
            
            usernameSpan.textContent = currentUser.username;
            
            if (currentUser.role === 'admin') {
                addBookBtn.style.display = 'flex';
                userInfo.style.background = 'rgba(44, 62, 80, 0.7)';
            } else {
                addBookBtn.style.display = 'none';
                userInfo.style.background = 'rgba(52, 152, 219, 0.7)';
            }
            
            renderBooks(books);
        }
        
        function logout() {
            currentUser = null;
            mainHeader.style.display = 'none';
            mainNav.style.display = 'none';
            statsSection.style.display = 'none';
            mainContent.style.display = 'none';
            mainFooter.style.display = 'none';
            loginModal.style.display = 'block';
            
            // Reset login forms
            adminForm.style.display = 'none';
            guestForm.style.display = 'none';
            adminBtn.classList.remove('active');
            guestBtn.classList.remove('active');
        }
        
        function changeView(viewType) {
            // Update active button
            viewBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.view === viewType);
            });
            
            // Show/hide views
            booksGrid.style.display = viewType === 'grid' ? 'grid' : 'none';
            booksList.style.display = viewType === 'list' ? 'flex' : 'none';
            booksTableContainer.style.display = viewType === 'table' ? 'block' : 'none';
        }
        
        function deleteBook() {
            if (!currentBookInModal) return;
            
            // Remove the book from the array
            books = books.filter(book => book.id !== currentBookInModal.id);
            
            // Close modals
            bookModal.style.display = 'none';
            confirmationModal.style.display = 'none';
            
            // Re-render books
            renderBooks(books);
            
            // Reset current book
            currentBookInModal = null;
        }
        
        function filterBooksByCategory(category) {
            if (category === "all") {
                sectionTitle.textContent = "أحدث الكتب المضافة";
                renderBooks(books);
                return;
            }
            
            const filteredBooks = books.filter(book => book.category === category);
            sectionTitle.textContent = `كتب في تصنيف: ${category}`;
            renderBooks(filteredBooks);
        }
        
        function filterBooksByAuthor(author) {
            const filteredBooks = books.filter(book => book.author === author);
            sectionTitle.textContent = `كتب المؤلف: ${author}`;
            renderBooks(filteredBooks);
        }
        
        function filterBooksByPublisher(publisher) {
            const filteredBooks = books.filter(book => book.publisher === publisher);
            sectionTitle.textContent = `كتب دار النشر: ${publisher}`;
            renderBooks(filteredBooks);
        }
        
        function handleSearch() {
            const term = searchInput.value.trim().toLowerCase();
            if (term === '') {
                // If no search term, show all books in current category
                filterBooksByCategory(currentCategory);
                return;
            }
            
            // Search in title, author and publisher
            const filteredBooks = books.filter(book => 
                book.title.toLowerCase().includes(term) || 
                book.author.toLowerCase().includes(term) ||
                book.publisher.toLowerCase().includes(term)
            );
            
            sectionTitle.textContent = `نتائج البحث عن: "${term}"`;
            renderBooks(filteredBooks);
        }
        
        function openAddBookModal() {
            addBookModal.style.display = 'block';
        }
        
        function saveNewBook(e) {
            e.preventDefault();
            
            const newBook = {
                id: books.length + 1,
                title: document.getElementById('book-title').value,
                author: document.getElementById('book-author').value,
                category: document.getElementById('book-category').value,
                edition: document.getElementById('book-edition').value,
                publisher: document.getElementById('book-publisher').value,
                year: document.getElementById('book-year').value,
                pages: document.getElementById('book-pages').value,
                volumes: document.getElementById('book-volumes').value,
                image: document.getElementById('book-image').value,
                location: document.getElementById('book-location').value,
                summary: document.getElementById('book-summary').value
            };
            
            books.push(newBook);
            
            // Close modal and reset form
            addBookModal.style.display = 'none';
            addBookForm.reset();
            
            // Show success message
            alert(`تمت إضافة كتاب "${newBook.title}" بنجاح`);
            
            // Re-render books
            renderBooks(books);
        }
        
        // Event Listeners
        // Close book modal
        closeBtn.addEventListener('click', () => {
            bookModal.style.display = 'none';
        });
        
        closeAddBtn.addEventListener('click', () => {
            addBookModal.style.display = 'none';
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === bookModal) {
                bookModal.style.display = 'none';
            }
            if (e.target === confirmationModal) {
                confirmationModal.style.display = 'none';
            }
            if (e.target === addBookModal) {
                addBookModal.style.display = 'none';
            }
        });
        
        // Delete book button
        deleteBookBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if (!currentBookInModal) return;
            
            confirmationMessage.textContent = `هل أنت متأكد من حذف كتاب "${currentBookInModal.title}"؟ لا يمكن التراجع عن هذا الإجراء.`;
            confirmationModal.style.display = 'block';
        });
        
        // Confirm deletion
        confirmDeleteBtn.addEventListener('click', deleteBook);
        
        // Cancel deletion
        cancelDeleteBtn.addEventListener('click', () => {
            confirmationModal.style.display = 'none';
        });
        
        // Edit book button
        editBookBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if (!currentBookInModal) return;
            
            alert(`ستقوم بتعديل كتاب: "${currentBookInModal.title}"`);
            // In a real app, we would open an edit form here
        });
        
        // Login buttons
        guestBtn.addEventListener('click', () => {
            guestBtn.classList.add('active');
            adminBtn.classList.remove('active');
            adminForm.style.display = 'none';
            guestForm.style.display = 'block';
        });
        
        adminBtn.addEventListener('click', () => {
            adminBtn.classList.add('active');
            guestBtn.classList.remove('active');
            guestForm.style.display = 'none';
            adminForm.style.display = 'block';
        });
        
        adminLoginBtn.addEventListener('click', () => {
            if (adminCodeInput.value === ADMIN_CODE) {
                loginUser('admin');
            } else {
                alert('كود المشرف غير صحيح!');
            }
        });
        
        guestLoginBtn.addEventListener('click', () => {
            loginUser('guest');
        });
        
        logoutBtn.addEventListener('click', logout);
        
        viewBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                changeView(btn.dataset.view);
            });
        });
        
        // Category buttons
        categoryBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all buttons
                categoryBtns.forEach(b => b.classList.remove('active'));
                // Add active class to clicked button
                btn.classList.add('active');
                // Filter books
                filterBooksByCategory(btn.dataset.category);
            });
        });
        
        // Author click in book modal
        modalAuthor.addEventListener('click', () => {
            const author = modalAuthor.dataset.author;
            bookModal.style.display = 'none';
            filterBooksByAuthor(author);
        });
        
        // Category click in book modal
        modalCategory.addEventListener('click', () => {
            const category = modalCategory.dataset.category;
            bookModal.style.display = 'none';
            filterBooksByCategory(category);
        });
        
        // Publisher click in book modal
        modalPublisher.addEventListener('click', () => {
            const publisher = modalPublisher.dataset.publisher;
            bookModal.style.display = 'none';
            filterBooksByPublisher(publisher);
        });
        
        // Add book button
        addBookBtn.addEventListener('click', openAddBookModal);
        
        // Cancel add book
        cancelAddBtn.addEventListener('click', () => {
            addBookModal.style.display = 'none';
        });
        
        // Save new book
        addBookForm.addEventListener('submit', saveNewBook);
        
        // Search button click
        searchBtn.addEventListener('click', handleSearch);
        
        // Search on Enter key
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleSearch();
            }
        });
        
        // Initialize the page
        loginModal.style.display = 'block';
        changeView('grid');
    </script>
</body>
</html>
